

<!DOCTYPE html>
<html>

<head>
  <title>Arco Research &amp; Documentation</title>
  <meta charset='utf-8'>

  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/font-awesome.css">
  <link rel="stylesheet" href="/css/highlight-default.css">
  <link rel="stylesheet" href="/css/style.css">

  <link rel="icon" type="image/png"  href="/images/icon.png">
</head>

<body>
  <div id="content" class="container" style="padding-top: 15px">


<link rel="stylesheet" href="/api/css/style.css">

<div class="box">
    <a href="/">
      <img src="/api/images/api-logo.png"
           style="padding: 0 25px; width: 110px" />
    </a>
    <h1 style="display: inline; font-weight: bold; font-size: 2.3em; padding-top: 10px">
      <a href="/api" style="color: inherit">API References</a>
    </h1>
  </div>

  <hr style="border: 1px solid #333333">


  <h1 id="mijia-smart-home-api-reference">Mijia Smart Home API reference</h1>
<h2 id="class-index">class index:</h2>
<ul>
<li><!-- raw HTML omitted -->LumiGateway<!-- raw HTML omitted --></li>
<li><!-- raw HTML omitted -->CubeAqgl01<!-- raw HTML omitted --></li>
<li><!-- raw HTML omitted -->Magnet<!-- raw HTML omitted --></li>
<li><!-- raw HTML omitted -->Motion<!-- raw HTML omitted --></li>
<li><!-- raw HTML omitted -->Plug<!-- raw HTML omitted --></li>
<li><!-- raw HTML omitted -->Switch<!-- raw HTML omitted --></li>
<li><!-- raw HTML omitted -->WeatherV1<!-- raw HTML omitted --></li>
</ul>
<!-- raw HTML omitted -->
<h1 id="span-classapi-modulemijiaspan-api-documentation"><!-- raw HTML omitted -->mijia<!-- raw HTML omitted --> API Documentation</h1>
<h2 id="anchor-class-LumiGateway">Class <!-- raw HTML omitted -->LumiGateway<!-- raw HTML omitted --></h2>
<p>This class is used to access a <em><strong>Lumi Gateway device</strong></em> (provided by Xiaomi / Aqara).
It will automatically try to discover devices on your network, using the <em>Lumi LAN
protocol</em>. It installs a thread to listen for incomming events, and also allows you
to change the device light color.</p>
<h3 id="span-classapi-propilluminationspan"><!-- raw HTML omitted --><code>illumination</code><!-- raw HTML omitted --></h3>
<p>[read only property] Stores the Gateway&rsquo;s provided value for its <strong>light
sensor</strong>. It&rsquo;s updated when a <em>change</em> event arrives, and on start-up.</p>
<h3 id="span-classapi-propstatusspan"><!-- raw HTML omitted --><code>status</code><!-- raw HTML omitted --></h3>
<p>A property that provides the status of this device, which could be:</p>
<ul>
<li><code>unknown</code>: there is <strong>not enough</strong> information to set a valid status. It receives
this state when the object is first created.</li>
<li><code>online</code>: some message arrived <strong>recently</strong> from the device, so it is up
and running correctly.</li>
<li><code>offline</code>: the device has <strong>not sent</strong> a heartbeat during its heartbeat period
(which is variable, but usually 10 minutes on battery devices).</li>
</ul>
<h3 id="span-classapi-func__init__span"><!-- raw HTML omitted --><code>__init__</code><!-- raw HTML omitted --></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> __init__(self, passwd<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>, mcast_member<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>)
</code></pre></div><p><!-- raw HTML omitted -->LumiGateway constructor. This is the <strong>starting point</strong> of the library. You will need
to create an instance of this class, and use it access other devices.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>password</code>, <em>[optional]</em> the Wireless communication protocol <strong>password</strong>, needed to
change the state of any device (which performs a <code>write</code> on the device).</li>
<li><code>mcast_member</code>, <em>[optional]</em> the IP address of the interface that will be used as
the <strong>multicast member</strong>. This address is used to receive events from the Lumi Gateway.
If not provided, it will try to <strong>automatically</strong> determine it.</li>
</ul>
<h3 id="span-classapi-funcget_devicesspan"><!-- raw HTML omitted --><code>get_devices</code><!-- raw HTML omitted --></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_devices</span>(self, filter<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>)
</code></pre></div><p><!-- raw HTML omitted -->Returns a <strong>dictionary</strong> (pairs of <code>sid</code> and <code>Device</code> objects) with the
currently linked devices.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>filter</code>: used to retrieve <strong>only</strong> devices of the given type. You
could use the class of a <code>Device</code>, its <code>type</code> property or even the
type value. For instance, to get only the <code>Switch</code> objects, you may
use any of the following options:</li>
</ul>
<p><code>gw.get_devices(filter=Switch)</code><!-- raw HTML omitted -->
<code>gw.get_devices(filter=Switch.type)</code><!-- raw HTML omitted -->
<code>gw.get_devices(filter=&quot;switch&quot;)</code></p>
<h3 id="span-classapi-funclight_offspan"><!-- raw HTML omitted --><code>light_off</code><!-- raw HTML omitted --></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">light_off</span>(self)
</code></pre></div><p><!-- raw HTML omitted -->Switch <strong>off</strong> Gateway&rsquo;s light. The same result could be achieved
providing 0 as intensity on <code>set_light_color()</code>.</p>
<h3 id="span-classapi-funcon_changespan"><!-- raw HTML omitted --><code>on_change</code><!-- raw HTML omitted --></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">on_change</span>(self, cb)
</code></pre></div><p><!-- raw HTML omitted -->Stablish a callback to be called when the Gateway&rsquo;s light sensor
changes. The callback signature should be as follows:</p>
<p><code>def callback([self,] event, device)</code></p>
<p>Where <code>event</code> is the <strong>name</strong> of this event (<em>change</em>), and <code>device</code> is
the Gateway device. To retrieve the <strong>current value</strong> of the light sensor,
use the property <code>illumination</code>.</p>
<h3 id="span-classapi-funcon_heartbeatspan"><!-- raw HTML omitted --><code>on_heartbeat</code><!-- raw HTML omitted --></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">on_heartbeat</span>(self, cb)
</code></pre></div><p><!-- raw HTML omitted -->Installs an <strong>event handler</strong> that will be called when this device sends a <code>heartbeat</code>
message.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>cb</code>: callback function to be called. It must <strong>accept two</strong> parameters: the event
<strong>name</strong> (a string), and the <strong>device</strong> that produces the event (a <code>Device</code> or
derived object).</li>
</ul>
<h3 id="span-classapi-funcset_light_colorspan"><!-- raw HTML omitted --><code>set_light_color</code><!-- raw HTML omitted --></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">set_light_color</span>(self, r<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, g<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, b<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)
</code></pre></div><p><!-- raw HTML omitted -->Changes the Gateway&rsquo;s light to the given <strong>color</strong> (by RGB components)
and <strong>intensity</strong>. Note that the provided values are <strong>relative</strong> to
each other, so a value of (1, 0, 0) will produce the same result as
(255, 0, 0).</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>r</code>: int in range [0, 255]; <strong>red</strong> component of the light&rsquo;s color.</li>
<li><code>g</code>: int in range [0, 255]; <strong>green</strong> component of the light&rsquo;s color.</li>
<li><code>b</code>: int in range [0, 255]; <strong>blue</strong> component of the light&rsquo;s color.</li>
<li><code>i</code>: int in range [0, 100]; light <strong>intensity</strong>.</li>
</ul>
<h3 id="span-classapi-funcstartspan"><!-- raw HTML omitted --><code>start</code><!-- raw HTML omitted --></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">start</span>(self)
</code></pre></div><p><!-- raw HTML omitted -->Start the <strong>discovery process</strong>. It will search for an active gateway, and then list its
linked devices. It also starts the <em>listening thread</em> to receive messages from
the Gateway. You usually will <strong>need</strong> to call this method.</p>
<h3 id="span-classapi-funcwait_until_breakspan"><!-- raw HTML omitted --><code>wait_until_break</code><!-- raw HTML omitted --></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">wait_until_break</span>(self)
</code></pre></div><p><!-- raw HTML omitted --><strong>Blocks</strong> the calling thread execution until it receives a <code>KeyboardInterrupt</code> (Ctrl+C)
Use it (or use instead an <strong>event loop</strong>) to keep the application <strong>running</strong> while
you wait for incoming events.</p>
<!-- raw HTML omitted -->
<h1 id="span-classapi-modulemijiadevicesspan-api-documentation"><!-- raw HTML omitted -->mijia.devices<!-- raw HTML omitted --> API Documentation</h1>
<h2 id="anchor-class-CubeAqgl01">Class <!-- raw HTML omitted -->CubeAqgl01<!-- raw HTML omitted --></h2>
<p>Mi Cube Controller, which is a device that detects <strong>different movements</strong>
or actions performed on itself: tap, double tap, flips of 90 and 180
degrees, rotation, move, shake, swing and free fall. It also works as a
<strong>motion sensor</strong>: when you touches it after a while, it will send an
<code>alert</code> event.</p>
<p>Except for the <code>rotate</code> event, all the attached callbacks should be in the
form:</p>
<p><code>def callback([self,], event, device)</code></p>
<p>Where <code>event</code> is the name of this event, and <code>device</code> is the device object
that produced the event.</p>
<h3 id="span-classapi-propstatusspan-1"><!-- raw HTML omitted --><code>status</code><!-- raw HTML omitted --></h3>
<p>A property that provides the status of this device, which could be:</p>
<ul>
<li><code>unknown</code>: there is <strong>not enough</strong> information to set a valid status. It receives
this state when the object is first created.</li>
<li><code>online</code>: some message arrived <strong>recently</strong> from the device, so it is up
and running correctly.</li>
<li><code>offline</code>: the device has <strong>not sent</strong> a heartbeat during its heartbeat period
(which is variable, but usually 10 minutes on battery devices).</li>
</ul>
<h3 id="span-classapi-funcon_alertspan"><!-- raw HTML omitted --><code>on_alert</code><!-- raw HTML omitted --></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">on_alert</span>(self, cb)
</code></pre></div><p><!-- raw HTML omitted -->Attach a callback handler for <code>alert</code> events. These events are sent when
the cube is <strong>moved after some time</strong> of inactivity (no movement).</p>
<h3 id="span-classapi-funcon_flip180span"><!-- raw HTML omitted --><code>on_flip180</code><!-- raw HTML omitted --></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">on_flip180</span>(self, cb)
</code></pre></div><p><!-- raw HTML omitted -->Attach a callback handler for <code>flip180</code> events. These events are produced
when the cube is <strong>flipped 180 degrees</strong> (i.e rotated on X and Y axis).</p>
<h3 id="span-classapi-funcon_flip90span"><!-- raw HTML omitted --><code>on_flip90</code><!-- raw HTML omitted --></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">on_flip90</span>(self, cb)
</code></pre></div><p><!-- raw HTML omitted -->Attach a callback handler for <code>flip90</code> events. These events are produced
when the cube is <strong>flipped 90 degrees</strong> (i.e rotated on X and Y axis).</p>
<h3 id="span-classapi-funcon_free_fallspan"><!-- raw HTML omitted --><code>on_free_fall</code><!-- raw HTML omitted --></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">on_free_fall</span>(self, cb)
</code></pre></div><p><!-- raw HTML omitted -->Attach a callback handler for <code>free_fall</code> events, which are sent when
you <strong>drop the cube</strong> (or it experiments some acceleration on the vertical axis).</p>
<h3 id="span-classapi-funcon_heartbeatspan-1"><!-- raw HTML omitted --><code>on_heartbeat</code><!-- raw HTML omitted --></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">on_heartbeat</span>(self, cb)
</code></pre></div><p><!-- raw HTML omitted -->Installs an <strong>event handler</strong> that will be called when this device sends a <code>heartbeat</code>
message.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>cb</code>: callback function to be called. It must <strong>accept two</strong> parameters: the event
<strong>name</strong> (a string), and the <strong>device</strong> that produces the event (a <code>Device</code> or
derived object).</li>
</ul>
<h3 id="span-classapi-funcon_movespan"><!-- raw HTML omitted --><code>on_move</code><!-- raw HTML omitted --></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">on_move</span>(self, cb)
</code></pre></div><p><!-- raw HTML omitted -->Attach a callback handler for <code>move</code> events, generated when you <strong>displace
the cube</strong> some small distance on the horizontal plane.</p>
<h3 id="span-classapi-funcon_rotatespan"><!-- raw HTML omitted --><code>on_rotate</code><!-- raw HTML omitted --></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">on_rotate</span>(self, cb)
</code></pre></div><p><!-- raw HTML omitted -->Attach a callback handler for <code>rotate</code> events, which are sent when you
<strong>rotate</strong> the cube along the vertical axis (Z axis).</p>
<p>The attached callbacks should be in the form:</p>
<p><code>def callback([self,], event, device, degrees, time)</code></p>
<p>Where <code>event</code> is the name of this event, <code>device</code> is the device object
that produced the event, <code>degrees</code> is the angle of the rotation, and
<code>time</code> is the time that took the sensor to measure the angle.</p>
<h3 id="span-classapi-funcon_shake_airspan"><!-- raw HTML omitted --><code>on_shake_air</code><!-- raw HTML omitted --></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">on_shake_air</span>(self, cb)
</code></pre></div><p><!-- raw HTML omitted -->Attach a callback handler for <code>shake_air</code> events, which are sent when
you take the cube and <strong>shake it</strong> on the air.</p>
<h3 id="span-classapi-funcon_swingspan"><!-- raw HTML omitted --><code>on_swing</code><!-- raw HTML omitted --></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">on_swing</span>(self, cb)
</code></pre></div><p><!-- raw HTML omitted -->Attach a callback handler for <code>swing</code> events. These events are signaled
when the cube makes a <strong>fast swing</strong> movement (one single shot is enough).
Note that it is also a trigger for the <code>iam</code> event (used to link the
cube to a Gateway).</p>
<h3 id="span-classapi-funcon_tap_twicespan"><!-- raw HTML omitted --><code>on_tap_twice</code><!-- raw HTML omitted --></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">on_tap_twice</span>(self, cb)
</code></pre></div><p><!-- raw HTML omitted -->Attach a callback handler for <code>tap_twice</code> events. These events are sent when
the cube is <strong>knocked twice</strong> on an horizontal hard surface.</p>
<h2 id="anchor-class-Magnet">Class <!-- raw HTML omitted -->Magnet<!-- raw HTML omitted --></h2>
<p>Aqara <strong>reed sensor</strong> (magnet) for detection of opening and close of doors
and windows. It emits an <code>open</code> event when the two components of the sensor
are separated, and a <code>close</code> event when they are joined together. Also,
<code>no_close</code> events are sent when the <strong>elapsed</strong> time from the last <code>open</code>
event <strong>reaches</strong> some pre-established thresholds (in the sensor firmware or
in the Gateway).</p>
<h3 id="span-classapi-propelapsed_no_closespan"><!-- raw HTML omitted --><code>elapsed_no_close</code><!-- raw HTML omitted --></h3>
<p>Gives the amount of elapsed <strong>time</strong> (in seconds) from the last <code>open</code>
event. It is <strong>provided</strong> with the <code>no_close</code> event from the sensor (not
computed locally).</p>
<h3 id="span-classapi-propopenspan"><!-- raw HTML omitted --><code>open</code><!-- raw HTML omitted --></h3>
<p><code>True</code> if the sensor detects that the door/window is open (or the two
components of the sensore are not together). <code>False</code> otherwise.</p>
<h3 id="span-classapi-propstatusspan-2"><!-- raw HTML omitted --><code>status</code><!-- raw HTML omitted --></h3>
<p>A property that provides the status of this device, which could be:</p>
<ul>
<li><code>unknown</code>: there is <strong>not enough</strong> information to set a valid status. It receives
this state when the object is first created.</li>
<li><code>online</code>: some message arrived <strong>recently</strong> from the device, so it is up
and running correctly.</li>
<li><code>offline</code>: the device has <strong>not sent</strong> a heartbeat during its heartbeat period
(which is variable, but usually 10 minutes on battery devices).</li>
</ul>
<h3 id="span-classapi-funcon_closespan"><!-- raw HTML omitted --><code>on_close</code><!-- raw HTML omitted --></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">on_close</span>(self, cb)
</code></pre></div><p><!-- raw HTML omitted -->Attach a callback handler for <code>close</code> events, which are sent when the
sensor detects the <strong>closing</strong> of the door/window. The attached callback
should be in the form:</p>
<p><code>def callback([self,], event, device)</code></p>
<p>Where <code>event</code> is the name of this event, and <code>device</code> is the device
object that produced the event.</p>
<h3 id="span-classapi-funcon_heartbeatspan-2"><!-- raw HTML omitted --><code>on_heartbeat</code><!-- raw HTML omitted --></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">on_heartbeat</span>(self, cb)
</code></pre></div><p><!-- raw HTML omitted -->Installs an <strong>event handler</strong> that will be called when this device sends a <code>heartbeat</code>
message.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>cb</code>: callback function to be called. It must <strong>accept two</strong> parameters: the event
<strong>name</strong> (a string), and the <strong>device</strong> that produces the event (a <code>Device</code> or
derived object).</li>
</ul>
<h3 id="span-classapi-funcon_no_closespan"><!-- raw HTML omitted --><code>on_no_close</code><!-- raw HTML omitted --></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">on_no_close</span>(self, cb)
</code></pre></div><p><!-- raw HTML omitted -->Attach a callback handler for <code>no_close</code> events, which are sent when the
<strong>elapsed time</strong> from the last <code>open</code> event reaches certain
thresholds (120 seconds, 300, 600, and so on). The elapsed time is
provided in the event, so the attached callback should be in the form:</p>
<p><code>def callback([self,], event, device, elapsed)</code></p>
<p>Where <code>event</code> is the name of this event, and <code>device</code> is the device
object that produced the event.</p>
<h3 id="span-classapi-funcon_openspan"><!-- raw HTML omitted --><code>on_open</code><!-- raw HTML omitted --></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">on_open</span>(self, cb)
</code></pre></div><p><!-- raw HTML omitted -->Attach callback handler for <code>open</code> events, which are sent when the
sensor detects the <strong>opening</strong> of the door/window. The attached callback
should be in the form:</p>
<p><code>def callback([self,], event, device)</code></p>
<p>Where <code>event</code> is the name of this event, and <code>device</code> is the device
object that produced the event.</p>
<h2 id="anchor-class-Motion">Class <!-- raw HTML omitted -->Motion<!-- raw HTML omitted --></h2>
<p>This is the Aqara <strong>PIR</strong> (or motion) sensor. It emits an event when a
<strong>moving</strong> object is detected, and some other events when the <strong>elapsed</strong>
time from the last motion detected <strong>reaches</strong> some pre-established
thresholds (in the sensor firmware or in the Gateway).</p>
<h3 id="span-classapi-propelapsed_no_motionspan"><!-- raw HTML omitted --><code>elapsed_no_motion</code><!-- raw HTML omitted --></h3>
<p>Gives the amount of elapsed <strong>time</strong> (in seconds) between the last <code>motion</code>
event and the last <code>no_motion</code> event. It is <strong>provided</strong> with the <code>no_motion</code>
event from the sensor (not computed locally).</p>
<h3 id="span-classapi-propstatusspan-3"><!-- raw HTML omitted --><code>status</code><!-- raw HTML omitted --></h3>
<p>A property that provides the status of this device, which could be:</p>
<ul>
<li><code>unknown</code>: there is <strong>not enough</strong> information to set a valid status. It receives
this state when the object is first created.</li>
<li><code>online</code>: some message arrived <strong>recently</strong> from the device, so it is up
and running correctly.</li>
<li><code>offline</code>: the device has <strong>not sent</strong> a heartbeat during its heartbeat period
(which is variable, but usually 10 minutes on battery devices).</li>
</ul>
<h3 id="span-classapi-funcon_heartbeatspan-3"><!-- raw HTML omitted --><code>on_heartbeat</code><!-- raw HTML omitted --></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">on_heartbeat</span>(self, cb)
</code></pre></div><p><!-- raw HTML omitted -->Installs an <strong>event handler</strong> that will be called when this device sends a <code>heartbeat</code>
message.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>cb</code>: callback function to be called. It must <strong>accept two</strong> parameters: the event
<strong>name</strong> (a string), and the <strong>device</strong> that produces the event (a <code>Device</code> or
derived object).</li>
</ul>
<h3 id="span-classapi-funcon_motionspan"><!-- raw HTML omitted --><code>on_motion</code><!-- raw HTML omitted --></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">on_motion</span>(self, cb)
</code></pre></div><p><!-- raw HTML omitted -->Attach a callback handler for <code>motion</code> events, which are sent when a
moving object passes through the field of view of the sensor. The
attached callback should be in the form:</p>
<p><code>def callback([self,], event, device)</code></p>
<p>Where <code>event</code> is the name of this event, and <code>device</code> is the device
object that produced the event.</p>
<h3 id="span-classapi-funcon_no_motionspan"><!-- raw HTML omitted --><code>on_no_motion</code><!-- raw HTML omitted --></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">on_no_motion</span>(self, cb)
</code></pre></div><p><!-- raw HTML omitted -->Attach a callback handler for <code>no_motion</code> events, which are sent when the
<strong>elapsed time</strong> from the last detected motion reaches certain
thresholds (120 seconds, 300, 600, and so on). The elapsed time is
provided in the event, so the attached callback should be in the form:</p>
<p><code>def callback([self,], event, device, elapsed)</code></p>
<p>Where <code>event</code> is the name of this event, and <code>device</code> is the device
object that produced the event.</p>
<h2 id="anchor-class-Plug">Class <!-- raw HTML omitted -->Plug<!-- raw HTML omitted --></h2>
<p>This is the Aqara plug controller. Emits <strong>2</strong> different events, to
<strong>notify</strong> if someone enabled or disabled the plug. You can also <strong>change
the state</strong> of the plug: enable or disable it. The properties <code>enabled</code> and
<code>inuse</code> will give you <strong>information</strong> about the plug usage.</p>
<p>All event callbacks <strong>should met</strong> the following signature:</p>
<p><code>def callback([self,], event, device)</code></p>
<p>Where <code>event</code> is the name of the event, and <code>device</code> is the device object
that produced this event.</p>
<h3 id="span-classapi-propenabledspan"><!-- raw HTML omitted --><code>enabled</code><!-- raw HTML omitted --></h3>
<p><code>True</code> if the plug is enabled (provides energy to the connected
appliance), <code>False</code> otherwise.</p>
<h3 id="span-classapi-propinusespan"><!-- raw HTML omitted --><code>inuse</code><!-- raw HTML omitted --></h3>
<p><code>True</code> if there are a <strong>connected</strong> appliance, and it is currently <strong>consuming</strong>
energy. <code>False</code> otherwise.</p>
<h3 id="span-classapi-propload_powerspan"><!-- raw HTML omitted --><code>load_power</code><!-- raw HTML omitted --></h3>
<p>Connected appliance (load) power usage, in watts (W).</p>
<h3 id="span-classapi-proppower_consumedspan"><!-- raw HTML omitted --><code>power_consumed</code><!-- raw HTML omitted --></h3>
<p>The cumulative load <strong>power consumption</strong> since the product was used, in
Wh.</p>
<h3 id="span-classapi-propstatusspan-4"><!-- raw HTML omitted --><code>status</code><!-- raw HTML omitted --></h3>
<p>A property that provides the status of this device, which could be:</p>
<ul>
<li><code>unknown</code>: there is <strong>not enough</strong> information to set a valid status. It receives
this state when the object is first created.</li>
<li><code>online</code>: some message arrived <strong>recently</strong> from the device, so it is up
and running correctly.</li>
<li><code>offline</code>: the device has <strong>not sent</strong> a heartbeat during its heartbeat period
(which is variable, but usually 10 minutes on battery devices).</li>
</ul>
<h3 id="span-classapi-funcon_heartbeatspan-4"><!-- raw HTML omitted --><code>on_heartbeat</code><!-- raw HTML omitted --></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">on_heartbeat</span>(self, cb)
</code></pre></div><p><!-- raw HTML omitted -->Installs an <strong>event handler</strong> that will be called when this device sends a <code>heartbeat</code>
message.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>cb</code>: callback function to be called. It must <strong>accept two</strong> parameters: the event
<strong>name</strong> (a string), and the <strong>device</strong> that produces the event (a <code>Device</code> or
derived object).</li>
</ul>
<h3 id="span-classapi-funcon_switch_offspan"><!-- raw HTML omitted --><code>on_switch_off</code><!-- raw HTML omitted --></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">on_switch_off</span>(self, cb)
</code></pre></div><p><!-- raw HTML omitted -->Attach callback handler for <code>switch_off</code> events, which are sent when
someone presses the <strong>built-in</strong> button of the plug (or otherwise
changes the <strong>enabled</strong> state), and the state goes from <code>on</code> to <code>off</code>.</p>
<h3 id="span-classapi-funcon_switch_onspan"><!-- raw HTML omitted --><code>on_switch_on</code><!-- raw HTML omitted --></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">on_switch_on</span>(self, cb)
</code></pre></div><p><!-- raw HTML omitted -->Attach callback handler for <code>switch_on</code> events, which are sent when
someone presses the <strong>built-in</strong> button of the plug (or otherwise
changes the <strong>enabled</strong> state), and the state goes from <code>off</code> to <code>on</code>.</p>
<h3 id="span-classapi-funcswitch_offspan"><!-- raw HTML omitted --><code>switch_off</code><!-- raw HTML omitted --></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">switch_off</span>(self)
</code></pre></div><p><!-- raw HTML omitted -->Call this method to <strong>disable</strong> the plug (does <strong>not</strong> provide energy to
connected appliance). Remember that you must provide a <strong>password</strong> on
the Gateway construction for this method to work.</p>
<h3 id="span-classapi-funcswitch_onspan"><!-- raw HTML omitted --><code>switch_on</code><!-- raw HTML omitted --></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">switch_on</span>(self)
</code></pre></div><p><!-- raw HTML omitted -->Call this method to <strong>enable</strong> the plug (provide energy to connected
appliance). Remember that you must provide a <strong>password</strong> on the Gateway
construction for this method to work.</p>
<h2 id="anchor-class-Switch">Class <!-- raw HTML omitted -->Switch<!-- raw HTML omitted --></h2>
<p>This is the Aqara push button that emits <strong>4</strong> different events. All event
callbacks <strong>should met</strong> the following signature:</p>
<p><code>def callback([self,], event, device)</code></p>
<p>Where <code>event</code> is the name of the event, and <code>device</code> is the device object
that produced this event.</p>
<h3 id="span-classapi-proppressedspan"><!-- raw HTML omitted --><code>pressed</code><!-- raw HTML omitted --></h3>
<p>Property to retrieve the <strong>current state</strong> of the push button: <code>true</code> is
pressed, <code>false</code> is not pressed.</p>
<h3 id="span-classapi-propstatusspan-5"><!-- raw HTML omitted --><code>status</code><!-- raw HTML omitted --></h3>
<p>A property that provides the status of this device, which could be:</p>
<ul>
<li><code>unknown</code>: there is <strong>not enough</strong> information to set a valid status. It receives
this state when the object is first created.</li>
<li><code>online</code>: some message arrived <strong>recently</strong> from the device, so it is up
and running correctly.</li>
<li><code>offline</code>: the device has <strong>not sent</strong> a heartbeat during its heartbeat period
(which is variable, but usually 10 minutes on battery devices).</li>
</ul>
<h3 id="span-classapi-funcon_clickspan"><!-- raw HTML omitted --><code>on_click</code><!-- raw HTML omitted --></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">on_click</span>(self, cb)
</code></pre></div><p><!-- raw HTML omitted -->Attach callback handler for <code>click</code> events, which is a <strong>single press</strong> on
the button.</p>
<h3 id="span-classapi-funcon_double_clickspan"><!-- raw HTML omitted --><code>on_double_click</code><!-- raw HTML omitted --></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">on_double_click</span>(self, cb)
</code></pre></div><p><!-- raw HTML omitted -->Attach callback handler for <code>double_click</code> events, which is a <strong>double press</strong> on
the button.</p>
<h3 id="span-classapi-funcon_heartbeatspan-5"><!-- raw HTML omitted --><code>on_heartbeat</code><!-- raw HTML omitted --></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">on_heartbeat</span>(self, cb)
</code></pre></div><p><!-- raw HTML omitted -->Installs an <strong>event handler</strong> that will be called when this device sends a <code>heartbeat</code>
message.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>cb</code>: callback function to be called. It must <strong>accept two</strong> parameters: the event
<strong>name</strong> (a string), and the <strong>device</strong> that produces the event (a <code>Device</code> or
derived object).</li>
</ul>
<h3 id="span-classapi-funcon_long_click_pressspan"><!-- raw HTML omitted --><code>on_long_click_press</code><!-- raw HTML omitted --></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">on_long_click_press</span>(self, cb)
</code></pre></div><p><!-- raw HTML omitted -->Attach callback handler for <code>long_click_press</code> events. These events are
produced when the button is <strong>pressed and maintained</strong> for more that 1
second. It is paired with the <code>long_click_release</code> event.</p>
<h3 id="span-classapi-funcon_long_click_releasespan"><!-- raw HTML omitted --><code>on_long_click_release</code><!-- raw HTML omitted --></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">on_long_click_release</span>(self, cb)
</code></pre></div><p><!-- raw HTML omitted -->Attach callback handler for <code>long_click_release</code> events. These events
are produced when the button is pressed, maintained for more that 1
second and then <strong>released</strong>. It is paired with the <code>long_click_press</code>
event.</p>
<h2 id="anchor-class-WeatherV1">Class <!-- raw HTML omitted -->WeatherV1<!-- raw HTML omitted --></h2>
<p>Aqara weather sensor (version 1.0). It provides readings for
<strong>temperature</strong>, <strong>humidity</strong> and air <strong>pressure</strong>. The latest provided
values for these magnitudes <strong>could be read</strong> any time from the
corresponding properties.</p>
<p>All event callbacks <strong>should met</strong> the following signature:</p>
<p><code>def callback([self,], event, device, value)</code></p>
<p>Where <code>event</code> is the name of the event, <code>device</code> is the device object that
produced this event, and <code>value</code> is the provided value (as <strong>integer</strong>) for that
magnitude.</p>
<h3 id="span-classapi-prophumidityspan"><!-- raw HTML omitted --><code>humidity</code><!-- raw HTML omitted --></h3>
<p>Last value provided on a <strong>humidity event</strong> (or retrieved on startup).</p>
<h3 id="span-classapi-proppressurespan"><!-- raw HTML omitted --><code>pressure</code><!-- raw HTML omitted --></h3>
<p>Last value provided on a <strong>pressure event</strong> (or retrieved on startup).</p>
<h3 id="span-classapi-propstatusspan-6"><!-- raw HTML omitted --><code>status</code><!-- raw HTML omitted --></h3>
<p>A property that provides the status of this device, which could be:</p>
<ul>
<li><code>unknown</code>: there is <strong>not enough</strong> information to set a valid status. It receives
this state when the object is first created.</li>
<li><code>online</code>: some message arrived <strong>recently</strong> from the device, so it is up
and running correctly.</li>
<li><code>offline</code>: the device has <strong>not sent</strong> a heartbeat during its heartbeat period
(which is variable, but usually 10 minutes on battery devices).</li>
</ul>
<h3 id="span-classapi-proptemperaturespan"><!-- raw HTML omitted --><code>temperature</code><!-- raw HTML omitted --></h3>
<p>Last value provided on a <strong>temperature event</strong> (or retrieved on startup).</p>
<h3 id="span-classapi-funcon_heartbeatspan-6"><!-- raw HTML omitted --><code>on_heartbeat</code><!-- raw HTML omitted --></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">on_heartbeat</span>(self, cb)
</code></pre></div><p><!-- raw HTML omitted -->Installs an <strong>event handler</strong> that will be called when this device sends a <code>heartbeat</code>
message.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>cb</code>: callback function to be called. It must <strong>accept two</strong> parameters: the event
<strong>name</strong> (a string), and the <strong>device</strong> that produces the event (a <code>Device</code> or
derived object).</li>
</ul>
<h3 id="span-classapi-funcon_humidityspan"><!-- raw HTML omitted --><code>on_humidity</code><!-- raw HTML omitted --></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">on_humidity</span>(self, cb)
</code></pre></div><p><!-- raw HTML omitted -->Attach callback handler for <code>humidity</code> events. Only sent when value
<strong>changes</strong> from previous one.</p>
<h3 id="span-classapi-funcon_pressurespan"><!-- raw HTML omitted --><code>on_pressure</code><!-- raw HTML omitted --></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">on_pressure</span>(self, cb)
</code></pre></div><p><!-- raw HTML omitted -->Attach callback handler for <code>pressure</code> events. Only sent when value
<strong>changes</strong> from previous one.</p>
<h3 id="span-classapi-funcon_temperaturespan"><!-- raw HTML omitted --><code>on_temperature</code><!-- raw HTML omitted --></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">on_temperature</span>(self, cb)
</code></pre></div><p><!-- raw HTML omitted -->Attach callback handler for <code>temperature</code> events. Only sent when value
<strong>changes</strong> from previous one.</p>





    </div> 

    <footer class="footer">
      <div class="container text-center">
        <a href="http://www.arcoresearch.com">ARCO Research Group</a> |
        <a href="/">Docs</a>&nbsp; - &nbsp;made with
        <a href="https://gohugo.io">Hugo</a> ·
        <a href="http://getbootstrap.com">Bootstrap</a>
      </div>
    </footer>

    <script src="/js/jquery.min.js"></script>
    <script src="/js/bootstrap.bundle.min.js"></script>
    <script src="/js/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>

