

<!DOCTYPE html>
<html>
  <head>
    <title>Inter Domain Messagging</title>
    <meta charset='utf-8'>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/idm/css/highlight-default.css">
    <link rel="stylesheet" href="/idm/css/style.css">
  </head>

  <body>
    <div id="content" class="container" style="padding-top: 15px">

      <div class="btn-group btn-group-justified" role="group">
	<a href="/idm/"
	   class="btn btn-default ">
	  Overview</a>
	<a href="/idm/examples/"
	   class="btn btn-success  active ">
	  Getting Started</a>
	<a href="/idm/spec/"
	   class="btn btn-default ">
	  Specification</a>
	<a href="/idm/news/"
	   class="btn btn-default disabled ">
	  Latest News</a>
      </div>





<br>
<h3>Let's start with the classic <b>"Hello World!"</b> example:</h3>

<hr>
<div class="row">
  <div class="col-xs-3">
    <a class="tab-link active" onClick="setActive(this)" href="#step1" data-toggle="tab">
      Step 1: The Interface</a>
  </div>

  <div class="col-xs-3">
    <a class="tab-link" onClick="setActive(this)" href="#step2" data-toggle="tab">
      Step 2: TCP Server</a>
  </div>

  <div class="col-xs-3">
    <a class="tab-link" onClick="setActive(this)" href="#step3" data-toggle="tab">
      Step 3: UDP Client</a>
  </div>

  <div class="col-xs-3">
    <a class="tab-link" onClick="setActive(this)" href="#step4" data-toggle="tab">
      Step 4: Running!</a>
  </div>
</div>

<div class="tab-content">
  <div role="tabpanel" class="tab-pane fade in active" id="step1">

    <div class="row">
      <div class="col-sm-6">
	<p>The interface is very simple, just <b>a method</b> to say
	  hello! On this example, we will use Python, so there is no
	  need to compile it...</p>
      </div>

      <div class="col-sm-6">
	<p>But if you prefer <b>another language</b>, just select the
	  apropiate <em>translator</em>:
      </div>
    </div>

    <div class="row">
      <div class="col-sm-6">
	<div class="app-skin">
	  <div class="filename">
	    <a download href="/idm/code/hello-world/interface.ice"
	       title="Click to download this code!">interface.ice</a>
	  </div>
	  <pre><code class="language-cpp">// 1. Define module and interface name
module Example {
    interface Hello {

        // 2. Add needed methods
        void sayIt();
    };
};
</code></pre>
	</div>
      </div>

      <div class="col-sm-6">
	<div class="app-skin shell">
	  <div class="filename">console</div>
	  <pre><code class="language-sh">$ slice2cpp interface.ice
$ slice2java interface.ice
$ slice2js interface.ice
$ slice2cs interface.ice
$ slice2php interface.ice
[...]

	  </code></pre>
	</div>
      </div>
    </div>

  </div>

  <div role="tabpanel" class="tab-pane fade" id="step2">
    <p>This server listens on a <b>TCP</b> port, waiting for incoming
      invocations. Its like any other
      <a href="https://doc.zeroc.com/display/Ice36/Writing+an+Ice+Application+with+Python">ZeroC Ice</a> server,
      you only need to also: <b>1)</b> load IDM slice, and <b>2)</b> using a valid
      IDM slice, <b>3)</b> register your proxy on IDM router.
    </p>

    <div class="app-skin">
      <div class="filename">
	<a download href="/idm/code/hello-world/server.py"
	   title="Click to download this code!">server.py</a>
      </div>
      <pre style="height: 300px"><code class="language-py">import sys
import Ice

# 1. Load IDM slice
Ice.loadSlice(&#34;/usr/share/slice/idm/idm.ice&#34;)
import IDM

Ice.loadSlice(&#34;interface.ice&#34;)
import Example

class HelloI(Example.Hello):
    def sayIt(self, current):
        print(&#34;Hello World!&#34;)

class Server(Ice.Application):
    def run(self, args):
        ic = self.communicator()

        # 2. Add servant with a valid IDM address
        address = ic.stringToIdentity(&#34;10AA02&#34;)

        adapter = ic.createObjectAdapter(&#34;Adapter&#34;)
        proxy = adapter.add(HelloI(), address)
        adapter.activate()

        # 3. Register proxy on IDM router
        router = ic.propertyToProxy(&#34;IDM.Router.Proxy&#34;)
        router = IDM.RouterPrx.checkedCast(router)
        router.adv(str(proxy))

        print(&#34;Ready, waiting events...&#34;)
        self.shutdownOnInterrupt()
        ic.waitForShutdown()

if __name__ == &#34;__main__&#34;:
    Server().main(sys.argv)
</code></pre>
    </div>

  </div>

  <div role="tabpanel" class="tab-pane fade" id="step3">
    <p>Create a regular <b>UDP</b> client. But wait... UDP? <b>Yes!</b> Thats the point
      with IDM, you can have <em>different</em> protocols on each
      side, like TCP, UDP, RS-485, ZigBee... No problem, IDM will make
      the message arrive to its correct destination.</p>

    <div class="app-skin">
      <div class="filename">
	<a download href="/idm/code/hello-world/client.py"
	   title="Click to download this code!">client.py</a>
      </div>
      <pre style="height: 300px"><code class="language-py">import sys
import Ice

Ice.loadSlice(&#34;interface.ice&#34;)
import Example

class Client(Ice.Application):
    def run(self, args):
        ic = self.communicator()

        # 1. Use remote object&#39;s IDM address
        address = ic.stringToIdentity(&#34;10AA02&#34;)

        # 2. Send the invocation through the IDM router
        remote = ic.propertyToProxy(&#34;IDM.Router.Proxy&#34;)
        remote = remote.ice_identity(address)
        remote = Example.HelloPrx.uncheckedCast(remote)

        remote.sayIt()

if __name__ == &#34;__main__&#34;:
    Client().main(sys.argv)
</code></pre>
    </div>
  </div>

  <div role="tabpanel" class="tab-pane fade" id="step4">
    <p>To make everything work, you need to run an <b>IDM router</b>
    first. Its very easy, just copy (or download) the following <i>configuration</i> file,
      <code>router.config</code>. Then, launch it as follows:
    </p>

    <div class="row">
      <div class="col-sm-6">

	<div class="app-skin">
	  <div class="filename">
	    <a download href="/idm/code/hello-world/router.config"
	       title="Click to download this code!">router.config</a>
	  </div>
	  <pre><code class="language-conf">Router.Table.Path = /tmp/router.table
Router.Adapter.Endpoints = tcp -h 127.0.0.1 -p 6140
Router.Ids = 10AA01
</code></pre>
	</div>

      </div>
      <div class="col-sm-6">

	<div class="app-skin shell">
	  <div class="filename">console</div>
	  <pre><code class="language-sh">$ idm-router --Ice.Config=router.config
[...]
INFO:root: waiting events...</code></pre>
	</div>

      </div>
    </div>

    <br>
    <p>Then, the second step is launching your <b>TCP server</b>. Again, copy
      or download the configuration file, <code>server.config</code>,
      and run the following command (you will see how it is registered
      on router):
    </p>

    <div class="row">
      <div class="col-sm-6">

	<div class="app-skin">
	  <div class="filename">
	    <a download href="/idm/code/hello-world/server.config"
	       title="Click to download this code!">server.config</a>
	  </div>
	  <pre><code class="language-conf">IDM.Router.Proxy = 10AA01 -t:tcp -h 127.0.0.1 -p 6140
Adapter.Endpoints = tcp

</code></pre>
	</div>

      </div>
      <div class="col-sm-6">

	<div class="app-skin shell">
	  <div class="filename">console</div>
	  <pre><code class="language-sh">$ python3 ./server.py --Ice.Config=server.config
Ready, waiting events...</code></pre>
	</div>

      </div>
    </div>

    <br>
    <p>Last, run the <b>UDP Client</b>: copy or download the config file,
      <code>client.config</code>, and run as indicated. If everything
      is as expected, you will see a "Hello World!" message on the
      server console, indicating that the method invocation arrived
      correctly. <b>Good job!</b>
    </p>

    <div class="row">
      <div class="col-sm-6">

	<div class="app-skin">
	  <div class="filename">
	    <a download href="/idm/code/hello-world/client.config"
	       title="Click to download this code!">client.config</a>
	  </div>
	  <pre><code class="language-conf">IDM.Router.Proxy = 10AA01 -t:tcp -h 127.0.0.1 -p 6140

</code></pre>
	</div>

      </div>
      <div class="col-sm-6">

	<div class="app-skin shell">
	  <div class="filename">console</div>
	  <pre><code class="language-sh">$ python3 ./client.py --Ice.Config=client.config</code></pre>
	</div>

      </div>
    </div>

  </div>

</div>

<script>
 function setActive(elem) {
     $('.tab-link.active').removeClass('active');
     $(elem).addClass('active');
 }
</script>

    </div> 

    <footer class="footer">
      <div class="container text-center">
	<a href="http://www.arcoresearch.com">ARCO Research Group</a> |
	<a href="/">Docs</a>&nbsp; - &nbsp;made with
	<a href="https://gohugo.io">Hugo</a> Â·
	<a href="http://getbootstrap.com">Bootstrap</a>
      </div>
    </footer>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>






